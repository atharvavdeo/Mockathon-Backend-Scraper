# Dashboard Elements Analysis & Backend Integration Guide

## üìã Overview

This document comprehensively maps all UI elements present in the Dashboard component and identifies which elements should be **dynamic** (updated with backend data) vs **static** (remain as mock/placeholder data).

---

## üèóÔ∏è Dashboard Structure (Top to Bottom)

### 1. **Header Section**
```
Location: Top of page
Status: ‚úÖ STATIC (No backend integration needed)
```

**Elements:**
- **Title**: "Analytics Dashboard"
- **Subtitle**: "Real-time insights and detection patterns"
- **Controls**:
  - Time Range Toggle: `7d | 30d | 90d` (affects chart data)
  - Metric View Toggle: `volume | ratio` (changes chart display mode)
  - Filters Button (currently non-functional)

**Backend Integration**: None needed (purely UI controls)

---

### 2. **Input Section (Form for Analysis)**
```
Location: Below header
Status: ‚úÖ CONNECTED TO BACKEND
Backend Endpoints: /api/v1/process-text, /api/v1/process-url, /api/v1/process-image
```

**Elements:**

#### Tab Selector (3 tabs)
- **Text Input Tab**
  - Article Title input field
  - Article Body textarea (minimum 100 characters)
  - Validation: Checks for minimum 100 characters
  
- **URL Input Tab**
  - URL input field with link icon
  - Placeholder: "Enter URL for the news here"
  - Note: "Fetch timeout guideline: 10‚Äì20 seconds"
  - Validation: Checks for non-empty URL
  
- **Image Upload Tab**
  - File upload drop zone
  - Displays selected filename when file chosen
  - Supported formats: PNG, JPG
  - Validation: Checks if file is selected

#### Form Controls
- **Error Display**: Red banner showing validation/API errors
- **Analyze Button**: 
  - Shows "Analyzing..." with spinner when loading
  - Disabled during analysis
  - Calls backend API based on active tab

**Backend Integration Status**: ‚úÖ FULLY INTEGRATED
- Text tab ‚Üí `POST /api/v1/process-text`
- URL tab ‚Üí `POST /api/v1/process-url`
- Image tab ‚Üí `POST /api/v1/process-image`

---

### 3. **Metrics Cards (4 cards in grid)**
```
Location: Below input section
Status: ‚ö†Ô∏è STATIC (Should be dynamic based on backend data)
```

**Current Mock Data:**

| Card | Value | Change | Icon | Color |
|------|-------|--------|------|-------|
| Total Analyses | 609 | +12% | Search | Blue |
| Accuracy Rate | 94% | +2% | Target | Green |
| Fake Detected | 198 | -8% | AlertTriangle | Red |
| Avg Response | 3.2s | -0.5s | Clock | Purple |

**Recommended Backend Integration**:
```typescript
// These should be fetched from backend analytics endpoint (future)
// Example structure:
interface DashboardMetrics {
  total_analyses: number;
  total_analyses_change: string; // "+12%"
  accuracy_rate: number; // 94
  accuracy_rate_change: string;
  fake_detected: number;
  fake_detected_change: string;
  avg_response_time: string; // "3.2s"
  avg_response_time_change: string;
}
```

**TODO**: Create backend endpoint `/api/v1/dashboard/metrics` to provide real-time stats

---

### 4. **Detection Trends Chart (Stacked Area Chart)**
```
Location: Below metrics cards
Status: ‚ö†Ô∏è MOCK DATA (Generated by generateSeries function)
```

**Current Implementation:**
- Uses `generateSeries()` function to create smooth, sinusoidal mock data
- Shows Real vs Fake detection over time
- Responsive to time range toggle (7d/30d/90d)
- Responsive to metric view toggle (volume/ratio)

**Mock Data Generator:**
```typescript
function generateSeries(days: number): Point[] {
  // Creates synthetic data with:
  // - realBase: 40 articles
  // - fakeBase: 28 articles
  // - Sinusoidal variation for realistic-looking trends
}
```

**Recommended Backend Integration**:
```typescript
// Should fetch from backend analytics endpoint
interface TrendData {
  date: string; // "Mon" or "D1"
  real: number;
  fake: number;
}

// Backend endpoint should accept:
// - range: "7d" | "30d" | "90d"
// - Returns array of TrendData points
```

**TODO**: Create backend endpoint `/api/v1/dashboard/trends?range=7d`

**Chart Features:**
- ‚úÖ Stacked area chart
- ‚úÖ Green gradient for Real news
- ‚úÖ Red gradient for Fake news
- ‚úÖ Custom tooltip with sorted values
- ‚úÖ Volume mode: absolute numbers
- ‚úÖ Ratio mode: percentages (always sum to 100%)

---

### 5. **Real vs Fake Line Chart**
```
Location: Left side, 2/3 width
Status: ‚ö†Ô∏è USES SAME MOCK DATA as Detection Trends
```

**Current Implementation:**
- Uses same `chartData` from Detection Trends
- Line chart instead of area chart
- Shows two lines: Real (green) and Fake (red)
- Responsive to same toggles (range, volume/ratio)

**Backend Integration**: Same as Detection Trends (shared data source)

---

### 6. **Recent Alerts Panel**
```
Location: Right side, 1/3 width (next to line chart)
Status: ‚ùå STATIC MOCK DATA
```

**Current Mock Data:**

| Title | Risk Level | Time | Count |
|-------|-----------|------|-------|
| Political Misinformation Campaign | Critical | 10 min ago | 23 instances |
| Health Hoax Spreading | High | 1 hour ago | 15 instances |
| Celebrity Death Rumor | Medium | 3 hours ago | 8 instances |

**Recommended Backend Integration**:
```typescript
interface Alert {
  title: string;
  risk: "Critical" | "High" | "Medium" | "Low";
  time: string; // "10 min ago" or ISO timestamp
  count: number; // instances detected
}
```

**TODO**: Create backend endpoint `/api/v1/dashboard/alerts` for real-time alerts

**Features:**
- Color-coded risk levels:
  - Critical: Red background
  - High: Orange background
  - Medium: Yellow background
- Hover effect (red border)

---

### 7. **Confidence Meter (Gauge)**
```
Location: Bottom section, left 1/3 width
Status: ‚ö†Ô∏è CALCULATED FROM MOCK CHART DATA
```

**Current Implementation:**
- Calculates confidence % from last point in chart data
- Formula: `real / (real + fake) * 100`
- SVG-based semi-circular gauge
- Shows percentage with needle indicator

**Recommended Backend Integration**:
```typescript
// Should reflect overall system confidence
interface ConfidenceMeter {
  confidence_percentage: number; // 0-100
  description: string; // "Based on latest analysis"
}
```

**TODO**: Update to use real system confidence from backend

---

### 8. **Insights Panel**
```
Location: Bottom section, right 2/3 width
Status: ‚ùå STATIC MOCK INSIGHTS
```

**Current Mock Data:**
- "Stable real-share across range"
- "Slight mid-week fake spike contained"
- "Response time steady under 4s"

**Recommended Backend Integration**:
```typescript
interface Insight {
  text: string;
  severity?: "info" | "warning" | "success";
}
```

**TODO**: Create backend endpoint `/api/v1/dashboard/insights` for AI-generated insights

---

### 9. **External Evidence Panel**
```
Location: Bottom-left, 2/3 width
Status: ‚ùå STATIC MOCK DATA
```

**Current Mock Data:**

| Source | Note |
|--------|------|
| Twitter/X | Skeptical reactions dominate |
| Reddit | Community flags misinformation threads |
| Fact-checkers | Two debunks found for similar claim |

**Recommended Backend Integration**:
```typescript
interface ExternalEvidence {
  source: string;
  note: string;
  url?: string; // Optional link to open
}
```

**TODO**: This could be integrated with real social media APIs or fact-checker databases

---

### 10. **Top Topics Panel**
```
Location: Bottom-right, 1/3 width
Status: ‚ùå STATIC MOCK TOPICS
```

**Current Mock Data:**
- Politics, Health, Tech, Finance, Science, Sports

**Recommended Backend Integration**:
```typescript
interface TopTopics {
  topics: Array<{
    name: string;
    count?: number; // number of articles
  }>;
}
```

**TODO**: Create backend endpoint `/api/v1/dashboard/topics` for trending topics

---

### 11. **Backend Results Section** (‚úÖ FULLY INTEGRATED)
```
Location: Appears dynamically after analysis
Status: ‚úÖ CONNECTED TO BACKEND
Visibility: Only shown when `result !== null`
```

**Elements:**

#### A. **Verdict Header**
- **Background color**: Dynamic based on verdict (red/green/yellow)
- **Verdict text**: FAKE | REAL | UNCERTAIN (from backend)
- **Subtitle**: Descriptive text based on verdict
- **Confidence**: Percentage from backend (0-100%)

**Backend Data Used:**
```typescript
result.evidence_analysis.verdict
result.evidence_analysis.confidence_value
```

#### B. **Analysis Details Card**
- **Title**: From `result.processed_input.title`
- **Word Count**: From `result.processed_input.word_count`
- **Source URL**: From `result.processed_input.source_url` (if URL analysis)
- **Extracted Text**: From `result.processed_input.image_text` (if image analysis)

#### C. **Explanation Card**
- **Content**: From `result.evidence_analysis.explanation`
- **Format**: Whitespace-preserved, multi-line text
- **Shows**: Detailed reasoning with bullet points

#### D. **Evidence Sources List**
- **Source count**: 5 fact-checker sources from backend
- **For each source**:
  - URL (clickable link)
  - Title
  - Snippet (description)
  - Similarity badge (High/Medium/Low) - color-coded

**Backend Data Used:**
```typescript
result.evidence_analysis.evidence.sources[]
  - url
  - title
  - snippet
  - similarity
```

#### E. **Processed Content Card**
- **Content**: Full processed/cleaned body text
- **Format**: Gray text, line-breaks preserved

---

### 12. **Static Results Preview** (Shows when no analysis)
```
Location: Bottom of page
Status: ‚ùå STATIC PLACEHOLDER
Visibility: Only shown when `result === null`
```

**Current Mock Data:**
- Verdict: "LIKELY FAKE"
- Confidence: 87%
- Key Warning Signals (3 bullet points)
- Agent Breakdown (3 mock agent scores)

**Purpose**: Placeholder to show UI structure before analysis is run

**Backend Integration**: Not needed (replaced by real results when available)

---

## üîÑ Data Flow Summary

### Current State (As Implemented)

```
User Action ‚Üí Frontend Form ‚Üí Backend API ‚Üí Response ‚Üí Update UI

TEXT INPUT:
1. User enters text (min 100 chars)
2. Clicks "Analyze" button
3. Frontend calls analyzeText(textBody)
4. POST /api/v1/process-text
5. Backend returns CompleteAnalysisResponse
6. Frontend displays:
   - Verdict card
   - Analysis details
   - Explanation
   - Evidence sources
   - Processed content

URL INPUT:
1. User enters URL
2. Clicks "Analyze" button
3. Frontend calls analyzeURL(urlInput)
4. POST /api/v1/process-url
5. Backend scrapes URL and analyzes
6. Frontend displays same as above + source_url

IMAGE INPUT:
1. User uploads image
2. Clicks "Analyze" button
3. Frontend calls analyzeImage(imageFile)
4. POST /api/v1/process-image
5. Backend extracts text via OCR and analyzes
6. Frontend displays same as above + image_text
```

---

## üìä Elements Status Matrix

| Element | Status | Backend Integration | Priority |
|---------|--------|-------------------|----------|
| Header & Controls | ‚úÖ Static | None needed | - |
| Input Form | ‚úÖ Connected | `/api/v1/process-*` | ‚úÖ DONE |
| Metrics Cards | ‚ö†Ô∏è Mock | Need `/dashboard/metrics` | HIGH |
| Detection Trends Chart | ‚ö†Ô∏è Mock | Need `/dashboard/trends` | HIGH |
| Line Chart | ‚ö†Ô∏è Mock | Same as trends | HIGH |
| Recent Alerts | ‚ùå Mock | Need `/dashboard/alerts` | MEDIUM |
| Confidence Meter | ‚ö†Ô∏è Calculated | Need real confidence | MEDIUM |
| Insights Panel | ‚ùå Mock | Need `/dashboard/insights` | LOW |
| External Evidence | ‚ùå Mock | Optional integration | LOW |
| Top Topics | ‚ùå Mock | Need `/dashboard/topics` | MEDIUM |
| Results Section | ‚úÖ Connected | `/api/v1/process-*` | ‚úÖ DONE |
| Static Preview | ‚úÖ Placeholder | Not needed | - |

---

## üéØ Integration Recommendations

### Phase 1: ‚úÖ COMPLETED
- [x] Connect input forms to backend
- [x] Display analysis results dynamically
- [x] Show verdict, confidence, explanation
- [x] Display evidence sources
- [x] Handle errors and loading states

### Phase 2: HIGH PRIORITY (Next Steps)
- [ ] Create `/api/v1/dashboard/metrics` endpoint
  - Return total analyses, accuracy, fake detected, avg response time
  - Include change percentages
  
- [ ] Create `/api/v1/dashboard/trends` endpoint
  - Accept `range` parameter (7d/30d/90d)
  - Return array of {date, real, fake} data points
  - Use actual historical analysis data from database

### Phase 3: MEDIUM PRIORITY
- [ ] Create `/api/v1/dashboard/alerts` endpoint
  - Return recent high-risk detections
  - Include title, risk level, timestamp, count
  
- [ ] Create `/api/v1/dashboard/topics` endpoint
  - Analyze trending topics from recent analyses
  - Return array of topic names

- [ ] Update confidence meter to use system-wide confidence

### Phase 4: LOW PRIORITY (Nice to Have)
- [ ] Create `/api/v1/dashboard/insights` endpoint
  - AI-generated insights based on recent patterns
  
- [ ] Integrate external evidence sources
  - Real social media sentiment analysis
  - Fact-checker API integrations

---

## üîå Required Backend Endpoints (To Be Created)

### 1. Dashboard Metrics
```http
GET /api/v1/dashboard/metrics
```

**Response:**
```json
{
  "total_analyses": 609,
  "total_analyses_change": "+12%",
  "accuracy_rate": 94,
  "accuracy_rate_change": "+2%",
  "fake_detected": 198,
  "fake_detected_change": "-8%",
  "avg_response_time": "3.2s",
  "avg_response_time_change": "-0.5s"
}
```

### 2. Detection Trends
```http
GET /api/v1/dashboard/trends?range=7d
```

**Query Parameters:**
- `range`: "7d" | "30d" | "90d"

**Response:**
```json
{
  "range": "7d",
  "data": [
    {"date": "Mon", "real": 45, "fake": 32},
    {"date": "Tue", "real": 52, "fake": 28},
    ...
  ]
}
```

### 3. Recent Alerts
```http
GET /api/v1/dashboard/alerts?limit=3
```

**Response:**
```json
{
  "alerts": [
    {
      "title": "Political Misinformation Campaign",
      "risk": "Critical",
      "time": "2025-10-06T10:45:00Z",
      "count": 23
    },
    ...
  ]
}
```

### 4. Top Topics
```http
GET /api/v1/dashboard/topics?limit=6
```

**Response:**
```json
{
  "topics": [
    {"name": "Politics", "count": 45},
    {"name": "Health", "count": 38},
    ...
  ]
}
```

### 5. Insights
```http
GET /api/v1/dashboard/insights?range=7d
```

**Response:**
```json
{
  "insights": [
    {
      "text": "Stable real-share across range",
      "severity": "info"
    },
    ...
  ]
}
```

---

## üí° State Management

### Current State Variables

```typescript
// Time range and view controls
const [range, setRange] = useState<'7d' | '30d' | '90d'>('7d')
const [metricView, setMetricView] = useState<'volume' | 'ratio'>('volume')
const [inputTab, setInputTab] = useState<'text'|'url'|'image'>('text')

// Form inputs
const [textTitle, setTextTitle] = useState('')
const [textBody, setTextBody] = useState('')
const [urlInput, setUrlInput] = useState('')
const [imageFile, setImageFile] = useState<File | null>(null)

// Analysis state
const [loading, setLoading] = useState(false)
const [error, setError] = useState<string | null>(null)
const [result, setResult] = useState<CompleteAnalysisResponse | null>(null)
```

### Future State Variables Needed

```typescript
// Dashboard analytics (when endpoints created)
const [metrics, setMetrics] = useState<DashboardMetrics | null>(null)
const [trends, setTrends] = useState<TrendData[] | null>(null)
const [alerts, setAlerts] = useState<Alert[] | null>(null)
const [topics, setTopics] = useState<string[] | null>(null)
const [insights, setInsights] = useState<Insight[] | null>(null)
```

---

## üé® UI Components Breakdown

### Conditional Rendering Logic

1. **Error Banner**: Shows when `error !== null`
2. **Loading State**: Button shows spinner when `loading === true`
3. **Results Section**: Shows when `result !== null`
4. **Static Preview**: Shows when `result === null`

### Dynamic Styling

1. **Verdict Colors**: Based on verdict type (FAKE/REAL/UNCERTAIN)
   - Background gradient
   - Text color
   - Border color

2. **Similarity Badges**: Color-coded by level
   - High: Green
   - Medium: Yellow
   - Low: Gray

3. **Risk Badges**: Color-coded by severity
   - Critical: Red
   - High: Orange
   - Medium: Yellow

---

## üìù Code Organization

### Functions

1. **generateSeries(days)**: Mock data generator for charts
2. **handleAnalyze()**: Main analysis trigger (calls backend)
3. **handleImageChange(e)**: File input handler
4. **getVerdictColor(verdict)**: Returns CSS classes for verdict backgrounds
5. **getVerdictTextColor(verdict)**: Returns CSS classes for verdict text
6. **CustomTooltip()**: Custom Recharts tooltip component

### Memoized Values

1. **rawData**: Generated mock series based on range
2. **chartData**: Processed data (volume or ratio mode)

### Computed Values

1. **yLabel**: "%" for ratio mode, undefined for volume
2. **yDomain**: [0, 100] for ratio, undefined for volume
3. **seriesLabel**: Different labels for volume vs ratio tooltips

---

## üöÄ Future Enhancements

### Recommendations for Dashboard Improvement

1. **Real-time Updates**
   - WebSocket connection for live analytics
   - Auto-refresh metrics every 30 seconds
   
2. **Data Filtering**
   - Implement the "Filters" button
   - Allow filtering by:
     - Date range
     - Verdict type
     - Topic category
     - Confidence threshold

3. **Export Functionality**
   - Export analysis results as PDF
   - Export charts as images
   - CSV export for data analysis

4. **Comparison Mode**
   - Compare multiple analyses side-by-side
   - Historical trend analysis

5. **User Customization**
   - Save favorite filters
   - Customize dashboard layout
   - Choose which metrics to display

6. **Performance Metrics**
   - Add response time tracking
   - Display API health status
   - Show system load indicators

---

## ‚úÖ Summary

### What's Working Now (Backend Connected)
- ‚úÖ Text analysis form ‚Üí Backend
- ‚úÖ URL analysis form ‚Üí Backend
- ‚úÖ Image analysis form ‚Üí Backend
- ‚úÖ Results display with verdict, confidence, explanation
- ‚úÖ Evidence sources display
- ‚úÖ Error handling and validation
- ‚úÖ Loading states with spinner

### What's Still Mock Data (Needs Backend)
- ‚ö†Ô∏è Metrics cards (Total Analyses, Accuracy, etc.)
- ‚ö†Ô∏è Detection trends chart
- ‚ö†Ô∏è Real vs Fake line chart
- ‚ùå Recent alerts
- ‚ö†Ô∏è Confidence meter
- ‚ùå Insights panel
- ‚ùå External evidence
- ‚ùå Top topics

### Priority Order for Backend Development
1. **HIGH**: Dashboard metrics and trends endpoints
2. **MEDIUM**: Alerts and topics endpoints
3. **LOW**: Insights and external evidence endpoints

---

**Last Updated:** October 6, 2025  
**Component File:** `/frontend/src/pages/Dashboard.tsx`  
**Backend Base URL:** `http://localhost:8000`
